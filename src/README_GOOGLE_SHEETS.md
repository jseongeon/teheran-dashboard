# 구글 스프레드시트 API 연동 가이드

이 대시보드는 구글 스프레드시트 API를 통해 실시간 데이터를 가져올 수 있습니다.

## 1. 구글 클라우드 프로젝트 설정

### 1.1 프로젝트 생성
1. [Google Cloud Console](https://console.cloud.google.com/) 접속
2. 새 프로젝트 생성 또는 기존 프로젝트 선택

### 1.2 Google Sheets API 활성화
1. 좌측 메뉴에서 "API 및 서비스" > "라이브러리" 선택
2. "Google Sheets API" 검색
3. "사용 설정" 클릭

### 1.3 API 키 생성
1. 좌측 메뉴에서 "API 및 서비스" > "사용자 인증 정보" 선택
2. "사용자 인증 정보 만들기" > "API 키" 선택
3. 생성된 API 키 복사

## 2. 스프레드시트 준비

### 2.1 스프레드시트 공유 설정
- 스프레드시트를 "링크가 있는 모든 사용자" 볼 수 있도록 설정
- 또는 API 키에 읽기 권한 부여

### 2.2 스프레드시트 구조

대시보드가 예상하는 시트 구조:

#### **상담 시트 (문의 데이터)**
| A (ID) | B (날짜) | C (분야) | D (변리사) | E (상태) | F (고객사) | G (출처) |
|--------|----------|----------|------------|----------|------------|----------|
| INQ-0001 | 2024-11-04 | 특허 | 윤웅채 | 처리중 | A 기업 | 홈페이지 |
| INQ-0002 | 2024-11-03 | 상표 | 김신연 | 완료 | B 기업 | 바이럴 |

**컬럼 설명:**
- **ID**: 문의 고유 번호 (예: INQ-0001)
- **날짜**: 문의 날짜 (YYYY-MM-DD 형식)
- **분야**: 특허, 상표, 디자인, 해외, 저작권, 분쟁, 가치평가, 권리이전, 기타
- **변리사**: 담당 변리사 이름 (윤웅채, 김신연, 이상담, 김봉근)
- **상태**: 처리중, 완료, 대기
- **고객사**: 고객사명
- **출처**: 홈페이지, 바이럴, 기타

#### **수임 시트 (계약 데이터)**
| A (ID) | B (날짜) | C (업무유형) | D (변리사) | E (고객사) | F (계약금액) | G (상태) | H (출처) |
|--------|----------|--------------|------------|------------|--------------|----------|----------|
| CON-0001 | 2024-11-04 | 특허 출원 | 윤웅채 | A 기업 | 5,000,000 | 진행중 | 홈페이지 |
| CON-0002 | 2024-11-03 | 상표 등록 | 김신연 | B 기업 | 3,500,000 | 완료 | 바이럴 |

**컬럼 설명:**
- **ID**: 계약 고유 번호 (예: CON-0001)
- **날짜**: 계약 날짜 (YYYY-MM-DD 형식)
- **업무유형**: 특허 출원, 상표 등록, 디자인 출원, 해외 특허, 분쟁 대응 등
- **변리사**: 담당 변리사 이름
- **고객사**: 고객사명
- **계약금액**: 계약 금액 (숫자 또는 "5,000,000" 형식)
- **상태**: 진행중, 완료, 계약
- **출처**: 홈페이지, 바이럴, 기타

#### **변리사현황 시트 (선택사항)**
| A (이름) | B (문의건) | C (수임건) | D (수임율) |
|----------|------------|------------|------------|
| 윤웅채 | 342 | 234 | 68.4 |
| 김신연 | 298 | 212 | 71.1 |

#### **분야현황 시트 (선택사항)**
| A (분야명) | B (건수) |
|------------|----------|
| 특허 | 435 |
| 상표 | 324 |

## 3. 환경 변수 설정

프로젝트 루트에 `.env` 파일 생성:

```env
VITE_GOOGLE_SHEETS_API_KEY=여기에_API_키_입력
VITE_SPREADSHEET_ID=여기에_스프레드시트_ID_입력
```

### 스프레드시트 ID 찾기
스프레드시트 URL에서 추출:
```
https://docs.google.com/spreadsheets/d/[이_부분이_SPREADSHEET_ID]/edit
```

## 4. 사용 방법

### 4.1 기본 사용
환경 변수가 설정되면 대시보드가 자동으로 구글 시트에서 데이터를 가져옵니다.

### 4.2 수동 새로고침
현재는 페이지 로드 시 데이터를 가져옵니다. 
나중에 자동 새로고침 기능을 추가할 수 있습니다.

### 4.3 목업 데이터
- API 키나 스프레드시트 ID가 없으면 자동으로 목업 데이터를 사용합니다.
- 개발 중에는 목업 데이터로 테스트할 수 있습니다.

## 5. 커스텀 시트 범위 (선택사항)

기본 범위를 변경하려면 `.env` 파일에 추가:

```env
VITE_SHEET_RANGE_INQUIRIES=상담!A2:G
VITE_SHEET_RANGE_CONTRACTS=수임!A2:H
VITE_SHEET_RANGE_ATTORNEYS=변리사현황!A2:D
VITE_SHEET_RANGE_FIELDS=분야현황!A2:B
```

## 6. 문제 해결

### API 키 오류
- API 키가 올바른지 확인
- Google Sheets API가 활성화되었는지 확인
- API 키 제한 설정 확인 (HTTP 리퍼러 제한 등)

### 데이터가 표시되지 않음
- 스프레드시트가 "링크가 있는 모든 사용자"에게 공개되었는지 확인
- 시트 이름이 정확한지 확인 (대소문자 구분)
- 범위 설정이 올바른지 확인
- 브라우저 콘솔에서 에러 메시지 확인

### CORS 오류
- Google Sheets API는 CORS를 지원하므로 일반적으로 문제 없음
- API 키 설정에서 허용된 웹사이트 확인

## 7. 보안 권장사항

⚠️ **중요**: 
- API 키를 GitHub 등 공개 저장소에 커밋하지 마세요
- `.env` 파일은 `.gitignore`에 포함되어 있는지 확인하세요
- 프로덕션 환경에서는 API 키 대신 OAuth 2.0 사용 권장
- API 키에 IP 주소나 HTTP 리퍼러 제한 설정 권장

## 8. 향후 개선 사항

- [ ] 자동 새로고침 (폴링)
- [ ] OAuth 2.0 인증 지원
- [ ] 오프라인 모드
- [ ] 데이터 캐싱
- [ ] 에러 리트라이 로직
